<% provide(:title, "Confirm Shifts") %>

<table class="table table-bordered table-condensed" id="next-shifts-table">
  <tr>
    <th>ポジション</th>
    <th>スタッフ名</th>
    <% @next_shifts.each do |day| %>
      <% if day.wday == 6 %>
        <th class="blue"><%= day.strftime('%-m/%-d') %> (<%= $days_of_the_week[day.wday] %>)</th>
      <% elsif day.wday == 0 %>
        <th class="red"><%= day.strftime('%-m/%-d') %> (<%= $days_of_the_week[day.wday] %>)</th>
      <% else %>
        <th><%= day.strftime('%-m/%-d') %> (<%= $days_of_the_week[day.wday] %>)</th>
      <% end %>
    <% end %>
  </tr>
  
  <% @kitchen_staff.each do |staff| %>
    <tr>
      <td>キッチン</td>
      <td><%= staff.name %></td>
      <% @next_shifts.each do |day| %>
        <td></td>
      <% end %>
    </tr>
  <% end %>
  
  <% @hole_staff.each do |staff| %>
    <tr>
      <td>ホール</td>
      <td><%= staff.name %></td>
      <% @next_shifts.each do |day| %>
        <td></td>
      <% end %>
    </tr>
  <% end %>
</table>

<div class="row">
  <div class="col-xs-3 col-md-3 search-shift-tittle"><p class="search-shift">日毎に作成：</p></div>
  <div class="col-xs-3 col-md-3">
    <%= form_with url: shifts_confirm_next_shifts_user_path(@user), method: :get, local: true do |f| %>
      <div class="col-xs-9 search-shift-form-left">
        <%= f.date_field :date, min: @first_day, max: @last_day, class: "form-control" %>
      </div>
      <div class="col-xs-3 search-shift-form-right">
        <%= f.submit "検索", class: "btn btn-md btn-block btn-primary" %>
      </div>
    <% end %>
  </div>
</div>

<div class="row"> 
  <div class="col-xs-3 col-md-3 search-shift-tittle"><p class="search-shift">スタッフ毎に作成：</p></div>
  <div class="col-xs-3 col-md-3">
    <%= form_with url: shifts_confirm_next_shifts_user_path(@user), method: :get, local: true do |f| %>
      <div class="col-xs-9 search-shift-form-left">
        <%= f.collection_select(:staff, @staffs, :id, :name, {prompt: "スタッフを選択"},
              {class: "form-control"}) %>
      </div>
      <div class="col-xs-3 search-shift-form-right">
        <%= f.submit "検索", class: "btn btn-md btn-block btn-primary" %>
      </div>
    <% end %>
  </div>
</div>

<% if params[:date] %>
  <div class="applying-shift-date"><%= l(@date, format: :long) %>の申請シフト一覧</div>

  <table class="table table-bordered table-condensed" id="applying-shifts-table-date">
    <tr>
      <th>ポジション</th>
      <th>スタッフ名</th>
      <th>希望開始時間</th>
      <th>希望終了時間</th>
      <th>出勤時間</th>
      <th>退勤時間</th>
    </tr>
    <% @shifts.each do |shift| %>
      <% find_user_by_shift(shift) %>
      <tr>
        <td><%= put_position(@staff) %></td>
        <td><%= @staff.name %></td>
        <td><%= shift.request_start_time %></td>
        <td><%= shift.request_end_time %></td>
        <td></td>
        <td></td>
      </tr>
    <% end %>
  </table>
<% end %>

<% if params[:staff] %>
  <div class="applying-shift-staff">の申請シフト一覧</div>
  
  <table class="table table-bordered table-condensed" id="applying-shifts-table-staff">
    <tr>
      <th>日付</th>
      <th>スタッフ名</th>
      <th>希望開始時間</th>
      <th>希望終了時間</th>
      <th>出勤時間</th>
      <th>退勤時間</th>
    </tr>
    <% @shifts.each do |shift| %>
      <tr>
        <td><%= put_position(@staff) %></td>
        <td><%= find_user_by_shift(shift).name %></td>
        <td><%= shift.request_start_time %></td>
        <td><%= shift.request_end_time %></td>
        <td></td>
        <td></td>
      </tr>
    <% end %>
  </table>
<% end %>
